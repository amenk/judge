#!/usr/bin/php
<?php
set_include_path(get_include_path() . PATH_SEPARATOR . realpath(dirname(__FILE__)));

require 'lib/Zend/Exception.php';
require 'lib/Zend/Config.php';
require 'lib/Zend/Config/Exception.php';
require 'lib/Zend/Config/Ini.php';

require_once __DIR__.'/lib/Symfony/Component/ClassLoader/UniversalClassLoader.php';

use Symfony\Component\ClassLoader\UniversalClassLoader;

$loader = new UniversalClassLoader();

// load default namespaces
$namespaces = array(
    //'Jumpstorm'        => __DIR__.'/src',
    'Judge'            => __DIR__.'/src',
    'Netresearch'      => __DIR__.'/lib',
    'Symfony'          => __DIR__.'/lib',
    'Zend'             => __DIR__.'/lib'
);

// add plugin namespaces dynamically
$pluginDirs = glob(__DIR__.'/plugins/*', GLOB_ONLYDIR);
foreach ($pluginDirs as $path) {
    $namespaces[basename($path)] = dirname($path);
}

$loader->registerNamespaces($namespaces);
$loader->registerNamespaceFallbacks(array(__DIR__.'/src'));
$loader->register();

use Symfony\Component\Console\Application;

$console = new Application('Judge', '0.1');
$console->add(new Judge\CoreHackDetector());
//$console->add(new Judge\RewriteCounter());
//$console->add(new Judge\MageCompat());
$console->run();
